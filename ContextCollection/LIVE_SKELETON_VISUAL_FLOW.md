# Visual User Flow - Live Skeleton Feature

## Complete Navigation Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        HOME SCREEN                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚    Live     â”‚  â”‚   Camera     â”‚  â”‚    Alerts     â”‚         â”‚
â”‚  â”‚ Monitoring  â”‚  â”‚   Images     â”‚  â”‚               â”‚         â”‚
â”‚  â”‚             â”‚  â”‚              â”‚  â”‚   (Click!)    â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚
                                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ALERTS SCREEN                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Alert List    â”‚  â”‚   Alert Details (Right Panel)      â”‚    â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚                                     â”‚    â”‚
â”‚  â”‚  ğŸ”´ Fall       â”‚  â”‚  ğŸ”´ Fall Detection Alert            â”‚    â”‚
â”‚  â”‚  Camera: C001  â”‚  â”‚  2024-10-20 14:30:45               â”‚    â”‚
â”‚  â”‚  (Selected)    â”‚  â”‚                                     â”‚    â”‚
â”‚  â”‚                â”‚  â”‚  Alert ID: 68f166168eeae9e...      â”‚    â”‚
â”‚  â”‚  ğŸŸ  Loiter     â”‚  â”‚  Camera: C001                       â”‚    â”‚
â”‚  â”‚  Camera: C002  â”‚  â”‚  Type: Fall                         â”‚    â”‚
â”‚  â”‚                â”‚  â”‚                                     â”‚    â”‚
â”‚  â”‚  ğŸŸ£ Intrusion  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  Camera: C001  â”‚  â”‚  â”‚ ğŸ“¹ View Live Skeleton        â”‚  â”‚    â”‚
â”‚  â”‚                â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚               â”‚ (NEW BUTTON!)      â”‚    â”‚
â”‚                      â”‚               â”‚                     â”‚    â”‚
â”‚                      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚                      â”‚  â”‚                               â”‚  â”‚    â”‚
â”‚                      â”‚  â”‚  [Background Image]           â”‚  â”‚    â”‚
â”‚                      â”‚  â”‚  [Skeleton Overlay]           â”‚  â”‚    â”‚
â”‚                      â”‚  â”‚  (From Alert Storage)         â”‚  â”‚    â”‚
â”‚                      â”‚  â”‚                               â”‚  â”‚    â”‚
â”‚                      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                        Click "View Live Skeleton"
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               LIVE SKELETON VIEWER SCREEN                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  Camera: [C001 - Lobby Camera â–¼]  [Connect]          â”‚      â”‚
â”‚  â”‚           â†‘                                           â”‚      â”‚
â”‚  â”‚      PRE-SELECTED from Alert!                        â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚                                                       â”‚      â”‚
â”‚  â”‚                                                       â”‚      â”‚
â”‚  â”‚          ğŸŸ¢ REAL-TIME SKELETON DISPLAY               â”‚      â”‚
â”‚  â”‚              (MQTT Stream)                            â”‚      â”‚
â”‚  â”‚                                                       â”‚      â”‚
â”‚  â”‚         ğŸ‘¤ Person detected                            â”‚      â”‚
â”‚  â”‚         (Animated stick figure)                       â”‚      â”‚
â”‚  â”‚                                                       â”‚      â”‚
â”‚  â”‚                                                       â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                 â”‚
â”‚  Status: Connected - 1 person(s) detected ğŸŸ¢                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Feature Comparison

### Before (Alert Skeleton Overlay)
```
âŒ Uses alert storage format (skeleton_file)
âŒ Format is undocumented/incompatible
âŒ Shows garbage data (invalid coordinates)
âŒ Static snapshot only (no animation)
âŒ Requires reverse-engineering binary format
```

### After (Live Skeleton Button)
```
âœ… Uses live MQTT stream (documented format)
âœ… Shows REAL skeleton data
âœ… Animated stick figure (real-time updates)
âœ… Auto-selects correct camera
âœ… One-click navigation
âœ… Uses working code (already implemented)
```

## Button Appearance

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Alert ID: 68f166168eeae9e50d48e58a     â”‚
â”‚  Camera: C001                            â”‚
â”‚  Type: Fall                              â”‚
â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ“¹  View Live Skeleton             â”‚ â”‚  â† GREEN BUTTON
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Code Architecture

```
alerts_screen.dart
    â”‚
    â”‚ User clicks "View Live Skeleton"
    â”‚
    â”œâ”€â–º Navigator.push(
    â”‚       SkeletonViewerScreen(
    â”‚           initialCameraSerialNumber: "C001"  â† PASSES CAMERA
    â”‚       )
    â”‚   )
    â”‚
    â–¼

skeleton_viewer_screen.dart
    â”‚
    â”œâ”€â–º Loads camera list from API
    â”‚
    â”œâ”€â–º Finds camera with serial "C001"
    â”‚   selectedCamera = cameraList.firstWhere(
    â”‚       (camera) => camera.serialNumber == "C001"
    â”‚   )
    â”‚
    â”œâ”€â–º User clicks "Connect"
    â”‚
    â”œâ”€â–º Gets MQTT config for camera
    â”‚
    â”œâ”€â–º Connects to MQTT broker
    â”‚
    â”œâ”€â–º Receives real-time skeleton frames
    â”‚
    â””â”€â–º Displays animated skeleton with SkeletonPainter
```

## Technical Breakdown

### Navigation Chain
1. **User Action**: Click alert in list
2. **System Action**: Load alert details with skeleton_file
3. **Display**: Show background image + (broken) skeleton overlay
4. **User Action**: Click "View Live Skeleton" button
5. **System Action**: Navigate to SkeletonViewerScreen with camera serial
6. **System Action**: Pre-select camera from alert
7. **User Action**: Click "Connect"
8. **System Action**: Establish MQTT connection
9. **Display**: Real-time animated skeleton

### Data Flow
```
Alert Object
    â†“
cameraSerialNumber: "C001"
    â†“
SkeletonViewerScreen(initialCameraSerialNumber: "C001")
    â†“
_loadCameras() â†’ Pre-select camera "C001"
    â†“
User clicks "Connect"
    â†“
getStreamConfig("C001") â†’ MQTT credentials
    â†“
MqttService.connect() â†’ Establish connection
    â†“
MQTT Stream â†’ Real skeleton frames
    â†“
SkeletonPainter â†’ Render animated stick figure
```

## User Benefits

### ğŸ¯ **Immediate Value**
- See what's happening RIGHT NOW at the camera
- No need to guess which camera to select
- One-click access to live view

### ğŸ”„ **Context Preservation**
- Automatic camera selection
- Seamless navigation
- Can return to alerts with back button

### ğŸ“Š **Better Data**
- Real-time updates (not static snapshot)
- Accurate skeleton rendering (not garbage data)
- Uses proven, working implementation

### ğŸ¨ **Improved UX**
- Clear, prominent button
- Intuitive icon (video camera)
- Professional green styling
- Matches "Live Monitoring" theme

## Implementation Status

| Component | Status | Notes |
|-----------|--------|-------|
| SkeletonViewerScreen parameter | âœ… DONE | Accepts optional camera serial |
| Camera pre-selection logic | âœ… DONE | Matches serial or falls back |
| "View Live Skeleton" button | âœ… DONE | Green button with icon |
| Navigation implementation | âœ… DONE | Passes camera serial number |
| Import statement | âœ… DONE | Added to alerts_screen.dart |
| Compilation check | âœ… DONE | No errors |
| Manual testing | â³ PENDING | User to test |

## Success Criteria

- [x] âœ… Button appears in alert details
- [x] âœ… Button navigates to Live Skeleton Viewer
- [x] âœ… Camera is pre-selected
- [ ] ğŸ”„ User can connect to MQTT stream
- [ ] ğŸ”„ Live skeleton displays correctly
- [ ] ğŸ”„ Back navigation works

## Related Files

- `Frontend/lib/screens/alerts_screen.dart` - Added button
- `Frontend/lib/screens/skeleton_viewer_screen.dart` - Added parameter
- `Frontend/lib/main.dart` - Updated const usage
- `LIVE_SKELETON_BUTTON_COMPLETE.md` - Implementation details
